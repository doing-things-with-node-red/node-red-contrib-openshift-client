<script type="text/x-red" data-template-name="ocEnv">
    <div class="form-row">
        <label for="node-input-name">
            <i class="icon-tag"></i>
            <span data-i18n="oc.label.name"></span>
        </label>
        <input type="text" id="node-input-name" data-i18n="[placeholder]node-red:common.label.name"> </div>
        <div class="form-row">
            <label for="node-input-objectSelection">
                <span data-i18n="oc.label.objectSelection"></span>
            </label>
            <input type="text" id="node-input-objectSelection" data-i18n="[placeholder]oc.placeholder.objectSelection" style="width: 60%;">
            <input type="hidden" id="node-input-objectSelectionFieldType">
        </div>
        <div class="form-row">
            <label for="node-input-variables">
                <span data-i18n="oc.label.read"></span>
            </label>
            <input type="checkbox" id="node-input-read">
        </div>
        <div class="form-row" id="node-div-variables">
            <label for="node-input-variables">
                <span data-i18n="oc.label.variables"></span>
            </label>
            <input type="text" id="node-input-variables" data-i18n="[placeholder]oc.placeholder.variables" style="width: 60%;">
            <input type="hidden" id="node-input-variablesFieldType">
        </div>
        <div class="form-row" id="node-div-formatOutput">
            <label for="node-input-formatOutput"><span data-i18n="oc.label.formatOutput"></span></label>
            <select id="node-input-formatOutput" style="width:180px;" />
        </div>
    </div>
</script>
<script type="text/javascript">
    RED.nodes.registerType("ocEnv", {
        category: "OpenShift",
        color: '#d4d4d4',
        defaults: {
            name: {
                value: ""
            },
            formatOutput: {
                value: "json"
            },
            objectSelection: {
                value: ""
            },
            objectSelectionFieldType: {
                value: "str"
            },
            variables: {
                value: 'payload'
            },
            variablesFieldType: {
                value: 'msg'
            },
            read: {
                value: false
            },
            output: {
                value: true
            },
            outputs: {
                value: 2
            }
        },
        inputs: 1,
        icon: "oc.png",
        align: "left",
        label: function () {
            return this.name || "oc-env";
        },
        labelStyle: function () {
            return this.name ? "node_label_italic" : "";
        },
        oneditprepare: function () {
            $("#node-input-objectSelection").typedInput({
                default: 'str',
                types: ['str', 'msg', 'flow', 'global'],
                typeField: $("#node-input-objectSelectionFieldType")
            });
            $("#node-input-variables").typedInput({
                default: 'msg',
                types: ['msg', 'flow', 'global'],
                typeField: $("#node-input-variablesFieldType")
            });
            $("#node-input-formatOutput").append($('<option>', {
                value: "json",
                text: "json"
            })).append($('<option>', {
                value: "yaml",
                text: "yaml"
            }));
            $('#node-input-read').change(function () {
                var value = $(this).is(":checked");
                var elementOutput = $("#node-div-formatOutput");
                var elementVariables = $("#node-div-variables");
                if (value) {
                    elementOutput.show();
                    elementVariables.hide();
                } else {
                    elementOutput.hide();
                    elementVariables.show();
                }
            });
        }
    });
</script>
